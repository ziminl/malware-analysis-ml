import pandas as pd
from sklearn.tree import DecisionTreeRegressor
from sklearn.metrics import mean_absolute_error

house_data = pd.read_csv('train.csv')

print("Here are the first 5 rows of the raw dataset")
print(house_data.head())


y = house_data['SalePrice']

house_features = ['LotArea', 'BedroomAbvGr', 'KitchenAbvGr']
X = house_data[house_features]

print("\nHere's a statistical summary of the data in the features columns")
print(X.describe())

print("\nDefining the model...")
house_model = DecisionTreeRegressor()
print("\nTraining the model...")
house_model.fit(X,y)

print('\nMaking predictions for the first five rows of the training set')
print("Here are the first 5 rows of the raw data for the features")
print(X.head())
print("Here are the first 5 actual prices")
print(y.head())
print("Here's what the model predicts for the first 5 prices")
print(house_model.predict(X.head()))


print("\nHere's a measure of the accuracy of our predictions")
print('Mean absolute error')


predicted_prices = house_model.predict(X)
print(mean_absolute_error(y, predicted_prices))


